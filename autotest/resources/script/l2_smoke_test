#S_CLI_STP_SET
spanning-tree mode rpvst+
spanning-tree max-age 6
spanning-tree forward-time 4
spanning-tree hello-time 1
spanning-tree enable
spanning-tree priority 4096
interface {output_port}
shutdown
interface range {dev_port1},{dev_port2}
no switchport access vlan
speed 100
duplex full
speed auto
channel-group 1 mode active
lacp timeout short
interface agg1
spanning-tree path-cost 20000
interface range {dev_port3},{dev_port4}
no switchport access vlan
spanning-tree path-cost 20000
end
clear port statistic
conf
#E_CLI_STP_SET
#S_NBR1_STP_SET
spanning-tree mode rpvst+
spanning-tree max-age 6
spanning-tree forward-time 4
spanning-tree hello-time 1
spanning-tree enable
spanning-tree priority 8192
interface range {(nbr1)input_port},{(nbr1)output_port}
shutdown
interface {(nbr1)nbr_port3}
no switchport access vlan
spanning-tree path-cost 20000
exit
interface range {(nbr1)nbr_port1},{(nbr1)nbr_port2}
no switchport access vlan
speed 100
duplex full
speed auto
channel-group 1 mode active
lacp timeout short
interface agg1
spanning-tree path-cost 20000
interface range {(nbr1)dev_port1},{(nbr1)dev_port2},{(nbr1)dev_port3}
no switchport access vlan
speed 100
duplex full
speed auto
static-channel-group 2
lacp timeout short
interface agg2
spanning-tree path-cost 20000
end
clear port statistic
conf
ip igmp snooping
#E_NBR1_STP_SET
#S_NBR2_STP_SET
spanning-tree mode rpvst+
spanning-tree max-age 6
spanning-tree forward-time 4
spanning-tree hello-time 1
spanning-tree enable
spanning-tree priority 12288
interface {(nbr2)input_port}
shutdown
interface {(nbr2)nbr_port4}
no switchport access vlan
spanning-tree path-cost 20000
exit
interface range {(nbr2)nbr_port1},{(nbr2)nbr_port2},{(nbr2)nbr_port3}
no switchport access vlan
speed 100
duplex full
speed auto
static-channel-group 2
lacp timeout short
interface agg2
spanning-tree path-cost 20000
end
clear port statistic
conf
#E_NBR2_STP_SET
#S_CLI_STP_BRIDGE_CHANGE_ROOT_SHOW
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_BRIDGE_CHANGE_ROOT_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_CLI_STP_BRIDGE_CHANGE_NON_ROOT_SHOW
spanning-tree priority 16384
end
sleep 25
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_BRIDGE_CHANGE_NON_ROOT_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_NBR1_STP_BRIDGE_CHANGE_ROOT_SHOW
end
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_NBR1_STP_BRIDGE_CHANGE_ROOT_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_NBR1_STP_PORT_PRIORITY_CHANGE
interface agg1
spanning-tree priority 32
exit
#E_NBR1_STP_PORT_PRIORITY_CHANGE
#S_CLI_STP_PORT_PRIORITY_CHANGE_SHOW
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_PORT_PRIORITY_CHANGE_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_NBR1_STP_PORT_PRIORITY_CHANGE
interface {(nbr1)nbr_port3}
spanning-tree priority 16
exit
#E_NBR1_STP_PORT_PRIORITY_CHANGE
#S_CLI_STP_PORT_PRIORITY_CHANGE_SHOW
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_PORT_PRIORITY_CHANGE_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_NBR1_STP_PORT_PRIORITY_CHANGE
interface agg1
no spanning-tree priority
interface {(nbr1)nbr_port3}
no spanning-tree priority
exit
#E_NBR1_STP_PORT_PRIORITY_CHANGE
#S_CLI_STP_PATH_COST_CHANGE_SHOW
interface agg1
spanning-tree path-cost 15000
end
sleep 25
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_PATH_COST_CHANGE_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_CLI_STP_PATH_COST_CHANGE_SHOW
interface agg1
spanning-tree path-cost 25000
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_PATH_COST_CHANGE_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_CLI_STP_FAILOVER_SHOW
interface {dev_port3}
shutdown
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_FAILOVER_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_CLI_STP_FAILOVER_SHOW
interface agg1
shutdown
end
sleep 15
show spanning-tree
show port-monitoring
show lacp statistics
conf
#E_CLI_STP_FAILOVER_SHOW
#S_NBR1_IGMP_GROUP_SHOW
end
clear mac address-table static
clear mac address-table multicast
clear mac address-table dynamic
sleep 3
show spanning-tree
show ip igmp snooping mrouter
show ip igmp groups
show mac-table
conf
#E_NBR1_IGMP_GROUP_SHOW
#S_CLI_STP_RECOVERY
interface range {output_port},{dev_port3}
no shutdown
interface agg1
no shutdown
no spanning-tree priority
no spanning-tree path-cost
interface range {dev_port1},{dev_port2}
no channel-group
interface {dev_port1}
switchport access vlan 100
interface {dev_port2}
switchport access vlan 200
interface {dev_port3}
switchport access vlan 300
no spanning-tree priority
no spanning-tree path-cost
interface {dev_port4}
switchport access vlan 400
no spanning-tree priority
no spanning-tree path-cost
exit
no spanning-tree forward-time
no spanning-tree max-age
no spanning-tree hello-time
no spanning-tree priority
spanning-tree disable
#E_CLI_STP_RECOVERY
#S_NBR1_STP_RECOVERY
interface range {(nbr1)input_port},{(nbr1)output_port}
no shutdown
interface agg1
no spanning-tree priority
no spanning-tree path-cost
interface agg2
no spanning-tree priority
no spanning-tree path-cost
interface range {(nbr1)nbr_port1},{(nbr1)nbr_port2}
no channel-group
interface {(nbr1)nbr_port1}
switchport access vlan 100
interface {(nbr1)nbr_port2}
switchport access vlan 200
interface range {(nbr1)dev_port1},{(nbr1)dev_port2},{(nbr1)dev_port3}
no static-channel-group
interface {(nbr1)dev_port1}
switchport access vlan 100
interface {(nbr1)dev_port2}
switchport access vlan 200
interface {(nbr1)dev_port3}
switchport access vlan 300
interface {(nbr1)nbr_port3}
switchport access vlan 300
no spanning-tree priority
no spanning-tree path-cost
interface {(nbr1)nbr_port4}
switchport access vlan 400
no spanning-tree priority
no spanning-tree path-cost
exit
no spanning-tree forward-time
no spanning-tree max-age
no spanning-tree hello-time
no spanning-tree priority
spanning-tree disable
no ip igmp snooping
#E_NBR1_STP_RECOVERY
#S_NBR2_STP_RECOVERY
interface {(nbr2)input_port}
no shutdown
interface agg2
no spanning-tree priority
no spanning-tree path-cost
interface range {(nbr2)nbr_port1},{(nbr2)nbr_port2},{(nbr2)nbr_port3}
no static-channel-group
interface {(nbr2)nbr_port1}
switchport access vlan 100
interface {(nbr2)nbr_port2}
switchport access vlan 200
interface {(nbr2)nbr_port3}
switchport access vlan 300
interface {(nbr2)nbr_port4}
no spanning-tree priority
no spanning-tree path-cost
switchport access vlan 400
exit
no spanning-tree forward-time
no spanning-tree max-age
no spanning-tree hello-time
no spanning-tree priority
spanning-tree disable
#E_NBR2_STP_RECOVERY
